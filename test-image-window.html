<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>画像ウィンドウテスト</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f0f0f0;
        }
        
        .info {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #27ae60;
        }
        
        button {
            padding: 10px 20px;
            font-size: 14px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <div class="info">
        <h3>🔧 画像ウィンドウ表示テスト</h3>
        <p><strong>テスト内容:</strong></p>
        <ul>
            <li>SimpleDragResizeWindowクラスのインスタンスが正しく作成されるか</li>
            <li>赤いタイトルバーの画像ウィンドウが表示されるか</li>
            <li>×ボタンが動作するか</li>
        </ul>
        <button onclick="testImageWindow()">画像ウィンドウを作成</button>
        <button onclick="checkExistingWindow()">既存ウィンドウをチェック</button>
    </div>
    
    <script type="module">
        import { SimpleDragResizeWindow } from './js/simple-drag-resize.js';
        
        let testWindow = null;
        
        window.testImageWindow = function() {
            console.log('testImageWindow called');
            
            // テスト用の画像データを作成
            const canvas = document.createElement('canvas');
            canvas.width = 300;
            canvas.height = 200;
            const ctx = canvas.getContext('2d');
            
            // テスト画像を描画
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#333';
            ctx.font = '24px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('テスト画像', canvas.width/2, canvas.height/2);
            
            const imageData = {
                url: canvas.toDataURL(),
                width: canvas.width,
                height: canvas.height
            };
            
            console.log('Creating SimpleDragResizeWindow with:', imageData);
            
            // 既存のウィンドウがあれば閉じる
            if (testWindow) {
                testWindow.close();
            }
            
            try {
                testWindow = new SimpleDragResizeWindow(imageData, (e) => {
                    console.log('Canvas clicked');
                }, () => {
                    console.log('Close button clicked');
                    if (testWindow) {
                        testWindow.close();
                        testWindow = null;
                    }
                });
                console.log('SimpleDragResizeWindow created successfully:', testWindow);
            } catch (error) {
                console.error('Error creating SimpleDragResizeWindow:', error);
            }
        };
        
        window.checkExistingWindow = function() {
            console.log('Current testWindow:', testWindow);
            const existingWindow = document.getElementById('imageWindow');
            console.log('Existing DOM element with id imageWindow:', existingWindow);
        };
    </script>
</body>
</html>